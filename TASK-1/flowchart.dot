digraph ATM_Para_Cekme {
    rankdir=TB;
    node [fontname="Arial"];

    // Düğüm şekilleri
    start [shape=oval, label="BAŞLA"];
    pin_giris [shape=parallelogram, label="PIN oku"];
    pin_kontrol [shape=diamond, label="PIN doğru mu?"];
    pin_hatalı [shape=box, label="deneme_hakki = deneme_hakki - 1"];
    pin_hak_kontrol [shape=diamond, label="deneme_hakki = 0 mı?"];
    kart_bloke [shape=parallelogram, label="Kart bloke mesajı yaz"];
    islem_basla [shape=parallelogram, label="PIN doğru mesajı yaz"];
    tutar_giris [shape=parallelogram, label="Tutar oku"];
    tutar_20kontrol [shape=diamond, label="Tutar 20'nin katı mı?"];
    bakiye_kontrol [shape=diamond, label="Tutar > bakiye mi?"];
    limit_kontrol [shape=diamond, label="Tutar > günlük limit mi?"];
    islem_yap [shape=box, label="bakiye = bakiye - tutar\nlimit = limit - tutar"];
    basarili_mesaj [shape=parallelogram, label="İşlem başarılı, bakiye ve limit yaz"];
    devam_sor [shape=parallelogram, label="Başka işlem? (E/H) oku"];
    devam_kontrol [shape=diamond, label="cevap = E veya e mi?"];
    bitir [shape=oval, label="BİTİR"];

    // Akış bağlantıları
    start -> pin_giris;
    pin_giris -> pin_kontrol;

    pin_kontrol -> islem_basla [label="Evet"];
    pin_kontrol -> pin_hatalı [label="Hayır"];

    pin_hatalı -> pin_hak_kontrol;
    pin_hak_kontrol -> kart_bloke [label="Evet"];
    pin_hak_kontrol -> pin_giris [label="Hayır"];
    kart_bloke -> bitir;

    islem_basla -> tutar_giris;
    tutar_giris -> tutar_20kontrol;

    tutar_20kontrol -> bakiye_kontrol [label="Evet"];
    tutar_20kontrol -> tutar_giris [label="Hayır\n(Yaz: 20 TL katı olmalı)"];

    bakiye_kontrol -> limit_kontrol [label="Hayır"];
    bakiye_kontrol -> tutar_giris [label="Evet\n(Yetersiz bakiye)"];

    limit_kontrol -> islem_yap [label="Hayır"];
    limit_kontrol -> tutar_giris [label="Evet\n(Limit aşıldı)"];

    islem_yap -> basarili_mesaj;
    basarili_mesaj -> devam_sor;
    devam_sor -> devam_kontrol;

    devam_kontrol -> tutar_giris [label="Evet"];
    devam_kontrol -> bitir [label="Hayır"];
}
